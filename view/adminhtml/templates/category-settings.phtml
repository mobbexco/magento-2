<h3><?= __('Plans Configuration') ?></h3>
<p><?= __('The enabled plans will appeared in the checkout for all the products in this category') ?></p>
<input type="hidden" name="mbbx_options_loaded" value="1" data-form-part='category_form'>

<?php
$id     = isset($this->params['id']) ? $this->params['id'] : 0;
$form   = 'category_form';

foreach ($this->config->catalogSettings as $value) {
    if (!strpos('subscription', $value))
        ${$value} = $this->config->getCatalogSetting($id, $value, 'category');
}

try {
    //Get plans sort order
    $sort = json_decode($this->config->customField->getCustomField(1, 'mobbex_plans', 'plans_order'), true);

    //Get Mobbex Sources
    $sources = \Mobbex\Repository::getFormatedSources($plans_configuration, $sort); 
} catch (\Exception $e) {
    $commonFields = $advancedFields = $sourceNames = [];
    $this->logger->log('error', "Template > getContent | {$e->getMessage()}");
}

include $this->getTemplateFile('Mobbex_Webpay::plans-filter.phtml');
include $this->getTemplateFile('Mobbex_Webpay::multivendor.phtml');
$this->helper->executeHook('mobbexCategorySettings', false, $id);
